<물리삭제와 논리삭제>
중경 평가 > 성적처리 > 자격증 관리코드에서 QL코드의 숫자 정렬에 관하여 요구사항이 들어왔다.
문제는 QL35000이라는 마지막 코드에서 다음 코드를 등록할 때에 QL36000이 아닌 QL37000이 뜬다는 것이었다.
그렇다면 왜 이런 문제가 생기는걸까? 

XML에 가서 코드를 수정했었다. 증가값이 SUBSTRING에서 증가값이 1 오르는걸 삭제했을 때 정상처리 된 줄 알았지만,
증가값을 올려야지만 다음 등록시에 코드값이 겹치지 않기 때문에 단편적으로 보이는 문제 해결이었다.

그래서 코드를 복구시키고 이해하니 다른 코드에서 문제가 있었다. 
바로 list를 불러오는 코드에서 문제가 있던 것이다. 때문에 어떤 곳에서 문제가 나는지 생각해 보았다.
우선 나의 생각은, QL35000까지 List에 출력되고, QL36000이 보이지 않으니 코드가 누락되어 나오지 않을까라고 생각했다.
하지만 그렇다는건 앞단쪽 문제의 가능성이 높기 때문에 배제하였다.

SUBSTRING이나 TO_NUMBER에서 +1되는 숫자 관련된 코드에 집중하다가 도현님께서 말씀주신 '물리삭제'와 '논리삭제'가 힌트라는 말을 얻었다.
물리삭제란? SQL의 DELETE 명령어를 사용하여 직접 데이터를 삭제하는 방법이다.
때문에 행을 무조건 삭제한다는 특징이 있다.
(삭제 대상인 데이터가 필요없을 때(추후에 조회할 필요없이 데이터를 지우려할 떄)사용)
논리삭제란? SQL의 UPDATE 명령어를 사용하여 삭제 여부를 알 수 있는 컬럼에 데이터가 삭제되었다는 값을 넣어서 표현한다.
때문에 행을 삭제하기보단 여부를 판단하여 UPDATE한다는 특징이 있다.
(삭제를 해도 삭제하기전의 데이터를 보관해야 할 경우 논리삭제를 사용)

이러한 힌트를 얻고 테이블의 컬럼을 조회해 봐야겠다고 생각했다.
SELECT QUFLCN_CL_CODE FROM TC_QUFLCN_CL;
-> QUFLCN_CL_CODE에 대한 값을 찾고자 검색해봤는데, QUFLCN_CL_CODE의 전체를 볼 수 있었다.

다음으로는 
select * from TC_QUFLCN_CL ;을 조회해 보았다.
-> 그런데, delete_at이라는 컬럼을 발견할 수 있었다. 
'N'과 'Y' 형태의 데이터들이 나열되었는데, 비교해보면 delete_at 값이 'N'인 게시글들만 출력되고 있었다.
때문에 리스트에서도 QL35000까지 나오고 삭제된 QL36000은 보이지 않았던 것이다.
그 이유는 바로 mapper 쿼리 중 조건절에 'WHERE NVL(A1.DELETE_AT, 'N')' 이 부분이 delete_at이 'N'인 값만 출력하고 있었다.
그렇기 때문에 delete_at이 'Y'인 QL32000과 QL36000 게시글이 보이지 않았던 것이다.
그래서 이 조건절을 지워주고 실행하니 QL32000과 QL36000 게시글이 출력되는 것을 확인할 수 있었다.

그치만 이건 삭제된 코드까지 출력해야하는 코드이기 때문에 추후에 다시 검토될 예정이다.